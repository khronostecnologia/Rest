ALTER TABLE "REGISTRO0000" ADD "MES" INTEGER;
ALTER TABLE "REGISTRO0000" ADD "ANO" INTEGER;

DROP VIEW "GET_EMP_IMPORTADOS";

CREATE OR REPLACE VIEW "GET_EMPRESAS" AS
SELECT "CODIGO","EMPRESA" FROM (
SELECT "COD_EMP" "CODIGO",CAST(UPPER("EMPRESA") AS CHARACTER VARYING(100))"EMPRESA"FROM "NF"
GROUP BY "CODIGO","EMPRESA"
UNION ALL
SELECT "CNPJ",CAST(UPPER("NOME") AS CHARACTER VARYING(100)) FROM "REGISTRO0000"
GROUP BY "CNPJ","NOME"
)A				   
GROUP BY "CODIGO","EMPRESA";

CREATE OR REPLACE VIEW "GET_EMP_XML_IMPORTADOS" AS
SELECT "COD_EMP" "CODIGO",CAST(UPPER("EMPRESA") AS CHARACTER VARYING(100))"EMPRESA",
"MES","ANO" FROM "NF"
GROUP BY "COD_EMP","EMPRESA","MES","ANO";

CREATE OR REPLACE VIEW "GET_EMP_SPED_IMPORTADOS" AS
SELECT "CNPJ" AS "CODIGO",CAST(UPPER("NOME") AS CHARACTER VARYING(100))"EMPRESA",
"MES","ANO" FROM "REGISTRO0000"
GROUP BY "CNPJ","NOME","MES","ANO";



